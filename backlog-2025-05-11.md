# Backlog Â· 10-Prompt Bootstrapper  (canonical task list)

ðŸ“ Legend  
- [ ] todo  Â·  - [x] done  
ðŸ”„ update / refine   âš ï¸ confirm with user before executing

---

## Phase 0 â–Repo & Environment

- [x] Init git repo, add codex.md layers, PRD, `.python-version` (pb-3.11.9).  
- [x] Verify venv activation, install PocketFlow, WeasyPrint, React scaffold.  
- [x] Create GitHub Action: Python 3.11 + Node 18, run `pytest -q`, **no deploy yet**.  

---

## Phase 1 â–Backend MVP (sync mode)

1. **PocketFlow DAG**  
   # Legacy nodes (group/rank-based prompts) are deprecated per updated PRD.
   - [x] `AssetsNode`â€ƒlogo_url + 3-5-HEX palette (ColorThief, cairosvg).
   - [ ] **`ScraperNode`**â€ƒcrawl depth=1 (homepage + first-level links), respect robots.txt, truncate text.
   - [ ] **`ExtractCopyNode`**â€ƒextract title, meta-description, H1-H3, JSON-LD; require â‰¥500 chars or fallback.
   - [ ] **`KeyPhrasesNode`**â€ƒstrip boilerplate, extract â‰¥15 key phrases for relevance.
   - [ ] **`PromptGeneratorNode`**â€ƒLLM generates exactly 10 prompts with 3-2-2-2-1 category mix, imperative verbs, business nouns, frameworks, â‰¤220 tokens.
   - [ ] **`ExplanationWriterNode`**â€ƒappend â‰¤30-word â€œWhen to useâ€ note to each prompt.
   - [ ] **`QualityFilterNode`**â€ƒfilter out duplicates (>85% similarity), missing business nouns, or toxicity >0.3.
   - [ ] **`PdfBuilderNode`**â€ƒWeasyPrint: one prompt per page, TOC 1â€“10, embed favicon if <100 kB, selectable text.

2. **FastAPI endpoints**  
   - [x] `POST /generate {url}` â†’ run new DAG, validate prompt count=10 else 422, **stream PDF** in response.  
   - [x] `GET /healthz` â†’ 200 OK.  

3. **Unit & integration tests**  
   - [ ] **Unit** â€” assert new nodes (`ScraperNode`, `ExtractCopyNode`, `PromptGeneratorNode`, etc.) meet functional specs.
   - [ ] **Integration** â€” full pipeline E2E: `example.com` â†’ 10-prompt JSON & PDF with 10 `<h2>` headings.
   - [ ] **Validation** â€” URL with <500 chars triggers fallback flow error / input prompt.
   - [ ] **Error** â€” request with insufficient prompt count returns HTTP 422.

---

## Phase 2 â–Frontend MVP

- [ ] `/Generate` page â€“ URL form â†’ POST /generate, spinner, render prompt cards, **â€œDownload PDFâ€**.  
- [ ] Tailwind + `fyne-core.css`, apply `palette[0]` to header.  
- [ ] Playwright e2e: generate prompts for `example.com`.

---

## Phase 3 â–Optional Enhancements

- [ ] Switch to async queue: Redis + RQ â†’ return `job_id`.  
- [ ] Upload PDF to S3 (or B2) + 24 h signed URL delivery.  
- [ ] **Save quick-view HTML** alongside PDF for WeasyPrint diffing.  
- [ ] Email sender Node (SES / Resend) with PDF link.  
- [ ] Postgres audit_log + PocketFlow Studio deployment.  
- [ ] Dark-mode PDF variant.

---

## Phase 4 â–CI / Deploy

- [ ] Add Render deploy step to GitHub Action (Python dyno + static build).  
- [ ] Terraform / infra blueprints in `/infra/` â€“ DB migrations only if Postgres is introduced.  
- [ ] Cost footprint check (stay â‰¤ $100 / mo).

---

### How Codex should update this file

* Tick `[x]` when a PR is merged **and commit the tick in that PR**.  
* Insert new tasks under the appropriate phase with a brief rationale.  
* If a task becomes blocked, add â€œâš ï¸ confirm with user â€¦â€ to its line.
